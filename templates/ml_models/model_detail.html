{% extends 'base.html' %}

{% block title %}Model {{ model.name }} - Zinara System{% endblock %}

{% block content %}
<div class="row mb-3">
    <div class="col-12 d-flex justify-content-between align-items-center">
        <h3><i class="fas fa-microchip"></i> Model {{ model.name }}</h3>
        <a class="btn btn-outline-secondary" href="{% url 'ml_models:model_list' %}"><i class="fas fa-arrow-left"></i> Back</a>
    </div>
</div>

<div class="row">
    <div class="col-md-6 mb-3">
        <div class="card">
            <div class="card-header"><strong>Details</strong></div>
            <div class="card-body">
                <div class="row mb-2"><div class="col-5 text-muted">Type</div><div class="col-7">{{ model.model_type|upper }}</div></div>
                <div class="row mb-2"><div class="col-5 text-muted">Status</div><div class="col-7"><span class="badge bg-{% if model.status == 'active' %}success{% elif model.status == 'training' %}warning{% elif model.status == 'failed' %}danger{% else %}secondary{% endif %}">{{ model.status|title }}</span></div></div>
                <div class="row mb-2"><div class="col-5 text-muted">Version</div><div class="col-7">{{ model.version }}</div></div>
                <div class="row mb-2"><div class="col-5 text-muted">Trained On</div><div class="col-7">{{ model.created_at|date:"Y-m-d H:i" }}</div></div>
                <div class="row mb-2"><div class="col-5 text-muted">Last Used</div><div class="col-7">{{ model.last_used|date:"Y-m-d H:i"|default:"-" }}</div></div>
                <div class="row mb-2"><div class="col-5 text-muted">Training Size</div><div class="col-7">{{ model.training_data_size|default:"-" }}</div></div>
                <div class="row mb-2"><div class="col-5 text-muted">Threshold</div><div class="col-7">{{ threshold|default:"-" }}</div></div>
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-3">
        <div class="card">
            <div class="card-header"><strong>Metrics</strong></div>
            <div class="card-body">
                <div class="row mb-2"><div class="col-5 text-muted">Accuracy</div><div class="col-7">{{ model.accuracy|floatformat:3|default:"-" }}</div></div>
                <div class="row mb-2"><div class="col-5 text-muted">Precision</div><div class="col-7">{{ model.precision|floatformat:3|default:"-" }}</div></div>
                <div class="row mb-2"><div class="col-5 text-muted">Recall</div><div class="col-7">{{ model.recall|floatformat:3|default:"-" }}</div></div>
                <div class="row mb-2"><div class="col-5 text-muted">F1 Score</div><div class="col-7">{{ model.f1_score|floatformat:3|default:"-" }}</div></div>
                <div class="row mb-2"><div class="col-5 text-muted">ROC AUC</div><div class="col-7">{{ model.roc_auc|floatformat:3|default:"-" }}</div></div>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6 mb-3">
        <div class="card">
            <div class="card-header"><strong>Confusion Matrix</strong></div>
            <div class="card-body">
                {% if confusion_matrix %}
                <div class="table-responsive">
                    <table class="table table-bordered mb-0 text-center">
                        <thead>
                            <tr>
                                <th></th>
                                <th>Predicted Negative</th>
                                <th>Predicted Positive</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <th class="text-start">Actual Negative</th>
                                <td>{{ confusion_matrix.0.0 }}</td>
                                <td>{{ confusion_matrix.0.1 }}</td>
                            </tr>
                            <tr>
                                <th class="text-start">Actual Positive</th>
                                <td>{{ confusion_matrix.1.0 }}</td>
                                <td>{{ confusion_matrix.1.1 }}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                {% else %}
                <p class="text-muted mb-0">Confusion matrix is not available.</p>
                {% endif %}
            </div>
        </div>
    </div>
    <div class="col-md-6 mb-3">
        <div class="card">
            <div class="card-header"><strong>Top Feature Importance</strong></div>
            <div class="card-body">
                {% if feature_importance %}
                <div class="table-responsive">
                    <table class="table table-sm">
                        <thead><tr><th>Feature</th><th>Importance</th></tr></thead>
                        <tbody>
                            {% for item in feature_importance.items %}
                            <tr><td>{{ item.0 }}</td><td>{{ item.1 }}</td></tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
                {% else %}
                <p class="text-muted mb-0">No feature importance available.</p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}

