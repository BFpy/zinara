{% extends 'base.html' %}

{% block title %}ML Models - Zinara System{% endblock %}

{% block content %}
<div class="row mb-3">
	<div class="col-12 d-flex justify-content-between align-items-center">
		<h3><i class="fas fa-brain"></i> ML Models</h3>
		<a class="btn btn-primary" href="{% url 'ml_models:train_model' %}"><i class="fas fa-plus"></i> Train New Model</a>
	</div>
</div>

<div class="card">
	<div class="card-body">
		{% if models %}
		<div class="table-responsive">
			<table class="table align-middle">
				<thead>
					<tr>
						<th>Name</th>
						<th>Type</th>
						<th>Status</th>
						<th>F1</th>
						<th>AUC</th>
						<th>Created</th>
						<th></th>
					</tr>
				</thead>
				<tbody>
					{% for m in models %}
					<tr>
						<td>{{ m.name }}</td>
						<td>{{ m.model_type }}</td>
						<td>
							<span class="badge bg-{% if m.status == 'active' %}success{% elif m.status == 'training' %}warning{% else %}secondary{% endif %}">
								{{ m.status|title }}
							</span>
						</td>
						<td>{{ m.f1_score|default:"-" }}</td>
						<td>{{ m.roc_auc|default:"-" }}</td>
						<td>{{ m.created_at|date:"Y-m-d H:i" }}</td>
						<td class="text-end">
							<a class="btn btn-sm btn-outline-primary" href="{% url 'ml_models:model_detail' m.id %}"><i class="fas fa-eye"></i> View</a>
							<form method="post" action="{% url 'ml_models:delete_model' m.id %}" style="display:inline-block;" onsubmit="return confirm('Are you sure you want to delete this model?');">{% csrf_token %}
								<button class="btn btn-sm btn-outline-danger" type="submit"><i class="fas fa-trash"></i> Delete</button>
							</form>
							<form method="post" action="{% url 'ml_models:activate_model' m.id %}" style="display:inline-block;">{% csrf_token %}
								{% if m.status == 'active' %}
								<button class="btn btn-sm btn-outline-warning" type="submit"><i class="fas fa-ban"></i> Deactivate</button>
								{% else %}
								<button class="btn btn-sm btn-outline-success" type="submit"><i class="fas fa-check"></i> Activate</button>
								{% endif %}
							</form>
						</td>
					</tr>
					{% endfor %}
				</tbody>
			</table>
		</div>
		{% else %}
		<p class="text-muted mb-0">No models yet. Train your first model.</p>
		{% endif %}
	</div>
	{% if page_obj %}
	<div class="card-footer">
		<nav>
			<ul class="pagination mb-0">
				{% if page_obj.has_previous %}
				<li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">Previous</a></li>
				{% endif %}
				<li class="page-item disabled"><span class="page-link">Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}</span></li>
				{% if page_obj.has_next %}
				<li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a></li>
				{% endif %}
			</ul>
		</nav>
	</div>
	{% endif %}
</div>
{% endblock %}

